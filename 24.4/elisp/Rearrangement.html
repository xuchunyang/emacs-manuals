<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 24.4.

Copyright Â© 1990-1996, 1998-2014 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "GNU General Public License," with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the
section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom." -->
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Rearrangement (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Rearrangement (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Rearrangement (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Modifying-Lists.html#Modifying-Lists" rel="up" title="Modifying Lists">
<link href="Sets-And-Lists.html#Sets-And-Lists" rel="next" title="Sets And Lists">
<link href="Setcdr.html#Setcdr" rel="prev" title="Setcdr">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="./manual.css">


</head>

<body lang="en">
<a name="Rearrangement"></a>
<div class="header">
<p>
Previous: <a href="Setcdr.html#Setcdr" accesskey="p" rel="prev">Setcdr</a>, Up: <a href="Modifying-Lists.html#Modifying-Lists" accesskey="u" rel="up">Modifying Lists</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html#Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="Functions-that-Rearrange-Lists"></a>
<h4 class="subsection">5.6.3 Functions that Rearrange Lists</h4>
<a name="index-rearrangement-of-lists"></a>
<a name="index-reordering_002c-of-elements-in-lists"></a>
<a name="index-modification-of-lists"></a>

<p>Here are some functions that rearrange lists &ldquo;destructively&rdquo; by
modifying the <small>CDR</small>s of their component cons cells.  We call these
functions &ldquo;destructive&rdquo; because they chew up the original lists passed
to them as arguments, relinking their cons cells to form a new list that
is the returned value.
</p>
<p>See <code>delq</code>, in <a href="Sets-And-Lists.html#Sets-And-Lists">Sets And Lists</a>, for another function
that modifies cons cells.
</p>
<dl>
<dt><a name="index-nconc"></a>Function: <strong>nconc</strong> <em>&amp;rest lists</em></dt>
<dd><a name="index-concatenating-lists"></a>
<a name="index-joining-lists"></a>
<p>This function returns a list containing all the elements of <var>lists</var>.
Unlike <code>append</code> (see <a href="Building-Lists.html#Building-Lists">Building Lists</a>), the <var>lists</var> are
<em>not</em> copied.  Instead, the last <small>CDR</small> of each of the
<var>lists</var> is changed to refer to the following list.  The last of the
<var>lists</var> is not altered.  For example:
</p>
<div class="example">
<pre class="example">(setq x '(1 2 3))
     &rArr; (1 2 3)
</pre><pre class="example">(nconc x '(4 5))
     &rArr; (1 2 3 4 5)
</pre><pre class="example">x
     &rArr; (1 2 3 4 5)
</pre></div>

<p>Since the last argument of <code>nconc</code> is not itself modified, it is
reasonable to use a constant list, such as <code>'(4 5)</code>, as in the
above example.  For the same reason, the last argument need not be a
list:
</p>
<div class="example">
<pre class="example">(setq x '(1 2 3))
     &rArr; (1 2 3)
</pre><pre class="example">(nconc x 'z)
     &rArr; (1 2 3 . z)
</pre><pre class="example">x
     &rArr; (1 2 3 . z)
</pre></div>

<p>However, the other arguments (all but the last) must be lists.
</p>
<p>A common pitfall is to use a quoted constant list as a non-last
argument to <code>nconc</code>.  If you do this, your program will change
each time you run it!  Here is what happens:
</p>
<div class="smallexample">
<pre class="smallexample">(defun add-foo (x)            ; <span class="roman">We want this function to add</span>
  (nconc '(foo) x))           ;   <span class="roman"><code>foo</code> to the front of its arg.</span>
</pre><pre class="smallexample">

</pre><pre class="smallexample">(symbol-function 'add-foo)
     &rArr; (lambda (x) (nconc (quote (foo)) x))
</pre><pre class="smallexample">

</pre><pre class="smallexample">(setq xx (add-foo '(1 2)))    ; <span class="roman">It seems to work.</span>
     &rArr; (foo 1 2)
</pre><pre class="smallexample">(setq xy (add-foo '(3 4)))    ; <span class="roman">What happened?</span>
     &rArr; (foo 1 2 3 4)
</pre><pre class="smallexample">(eq xx xy)
     &rArr; t
</pre><pre class="smallexample">

</pre><pre class="smallexample">(symbol-function 'add-foo)
     &rArr; (lambda (x) (nconc (quote (foo 1 2 3 4) x)))
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-nreverse"></a>Function: <strong>nreverse</strong> <em>list</em></dt>
<dd><a name="index-reversing-a-list"></a>
<p>This function reverses the order of the elements of <var>list</var>.
Unlike <code>reverse</code>, <code>nreverse</code> alters its argument by reversing
the <small>CDR</small>s in the cons cells forming the list.  The cons cell that
used to be the last one in <var>list</var> becomes the first cons cell of the
value.
</p>
<p>For example:
</p>
<div class="example">
<pre class="example">(setq x '(a b c))
     &rArr; (a b c)
</pre><pre class="example">x
     &rArr; (a b c)
(nreverse x)
     &rArr; (c b a)
</pre><pre class="example">;; <span class="roman">The cons cell that was first is now last.</span>
x
     &rArr; (a)
</pre></div>

<p>To avoid confusion, we usually store the result of <code>nreverse</code>
back in the same variable which held the original list:
</p>
<div class="example">
<pre class="example">(setq x (nreverse x))
</pre></div>

<p>Here is the <code>nreverse</code> of our favorite example, <code>(a b c)</code>,
presented graphically:
</p>
<div class="smallexample">
<pre class="smallexample"><span class="roman">Original list head:</span>                       <span class="roman">Reversed list:</span>
 -------------        -------------        ------------
| car  | cdr  |      | car  | cdr  |      | car | cdr  |
|   a  |  nil |&lt;--   |   b  |   o  |&lt;--   |   c |   o  |
|      |      |   |  |      |   |  |   |  |     |   |  |
 -------------    |   --------- | -    |   -------- | -
                  |             |      |            |
                   -------------        ------------
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-sort"></a>Function: <strong>sort</strong> <em>list predicate</em></dt>
<dd><a name="index-stable-sort"></a>
<a name="index-sorting-lists"></a>
<p>This function sorts <var>list</var> stably, though destructively, and
returns the sorted list.  It compares elements using <var>predicate</var>.  A
stable sort is one in which elements with equal sort keys maintain their
relative order before and after the sort.  Stability is important when
successive sorts are used to order elements according to different
criteria.
</p>
<p>The argument <var>predicate</var> must be a function that accepts two
arguments.  It is called with two elements of <var>list</var>.  To get an
increasing order sort, the <var>predicate</var> should return non-<code>nil</code> if the
first element is &ldquo;less than&rdquo; the second, or <code>nil</code> if not.
</p>
<p>The comparison function <var>predicate</var> must give reliable results for
any given pair of arguments, at least within a single call to
<code>sort</code>.  It must be <em>antisymmetric</em>; that is, if <var>a</var> is
less than <var>b</var>, <var>b</var> must not be less than <var>a</var>.  It must be
<em>transitive</em>&mdash;that is, if <var>a</var> is less than <var>b</var>, and <var>b</var>
is less than <var>c</var>, then <var>a</var> must be less than <var>c</var>.  If you
use a comparison function which does not meet these requirements, the
result of <code>sort</code> is unpredictable.
</p>
<p>The destructive aspect of <code>sort</code> is that it rearranges the cons
cells forming <var>list</var> by changing <small>CDR</small>s.  A nondestructive sort
function would create new cons cells to store the elements in their
sorted order.  If you wish to make a sorted copy without destroying the
original, copy it first with <code>copy-sequence</code> and then sort.
</p>
<p>Sorting does not change the <small>CAR</small>s of the cons cells in <var>list</var>;
the cons cell that originally contained the element <code>a</code> in
<var>list</var> still has <code>a</code> in its <small>CAR</small> after sorting, but it now
appears in a different position in the list due to the change of
<small>CDR</small>s.  For example:
</p>
<div class="example">
<pre class="example">(setq nums '(1 3 2 6 5 4 0))
     &rArr; (1 3 2 6 5 4 0)
</pre><pre class="example">(sort nums '&lt;)
     &rArr; (0 1 2 3 4 5 6)
</pre><pre class="example">nums
     &rArr; (1 2 3 4 5 6)
</pre></div>

<p><strong>Warning</strong>: Note that the list in <code>nums</code> no longer contains
0; this is the same cons cell that it was before, but it is no longer
the first one in the list.  Don&rsquo;t assume a variable that formerly held
the argument now holds the entire sorted list!  Instead, save the result
of <code>sort</code> and use that.  Most often we store the result back into
the variable that held the original list:
</p>
<div class="example">
<pre class="example">(setq nums (sort nums '&lt;))
</pre></div>

<p>See <a href="Sorting.html#Sorting">Sorting</a>, for more functions that perform sorting.
See <code>documentation</code> in <a href="Accessing-Documentation.html#Accessing-Documentation">Accessing Documentation</a>, for a
useful example of <code>sort</code>.
</p></dd></dl>

<hr>
<div class="header">
<p>
Previous: <a href="Setcdr.html#Setcdr" accesskey="p" rel="prev">Setcdr</a>, Up: <a href="Modifying-Lists.html#Modifying-Lists" accesskey="u" rel="up">Modifying Lists</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html#Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
